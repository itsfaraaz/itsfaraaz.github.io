<h1 id="npm-version1">npm-version(1)</h1>

<h2 id="bump-a-package-version">Bump a package version</h2>

<h3 id="synopsis">Synopsis</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm version <span class="o">[</span>&lt;newversion&gt; | major | minor | patch | premajor | preminor | prepatch | prerelease <span class="o">[</span><span class="nt">--preid</span><span class="o">=</span>&lt;prerelease-id&gt;] | from-git]

<span class="s1">'npm [-v | --version]'</span> to print npm version
<span class="s1">'npm view &lt;pkg&gt; version'</span> to view a package<span class="s1">'s published version
'</span>npm <span class="nb">ls</span><span class="s1">' to inspect current package/dependency versions
</span></code></pre></div></div>

<h3 id="description">Description</h3>

<p>Run this in a package directory to bump the version and write the new
data back to <code class="highlighter-rouge">package.json</code>, <code class="highlighter-rouge">package-lock.json</code>, and, if present, <code class="highlighter-rouge">npm-shrinkwrap.json</code>.</p>

<p>The <code class="highlighter-rouge">newversion</code> argument should be a valid semver string, a
valid second argument to <a href="https://github.com/npm/node-semver#functions">semver.inc</a> (one of <code class="highlighter-rouge">patch</code>, <code class="highlighter-rouge">minor</code>, <code class="highlighter-rouge">major</code>,
<code class="highlighter-rouge">prepatch</code>, <code class="highlighter-rouge">preminor</code>, <code class="highlighter-rouge">premajor</code>, <code class="highlighter-rouge">prerelease</code>), or <code class="highlighter-rouge">from-git</code>. In the second case,
the existing version will be incremented by 1 in the specified field.
<code class="highlighter-rouge">from-git</code> will try to read the latest git tag, and use that as the new npm version.</p>

<p>If run in a git repo, it will also create a version commit and tag.
This behavior is controlled by <code class="highlighter-rouge">git-tag-version</code> (see below), and can
be disabled on the command line by running <code class="highlighter-rouge">npm --no-git-tag-version version</code>.
It will fail if the working directory is not clean, unless the <code class="highlighter-rouge">-f</code> or
<code class="highlighter-rouge">--force</code> flag is set.</p>

<p>If supplied with <code class="highlighter-rouge">-m</code> or <code class="highlighter-rouge">--message</code> config option, npm will
use it as a commit message when creating a version commit.  If the
<code class="highlighter-rouge">message</code> config contains <code class="highlighter-rouge">%s</code> then that will be replaced with the
resulting version number.  For example:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm version patch <span class="nt">-m</span> <span class="s2">"Upgrade to %s for reasons"</span>
</code></pre></div></div>

<p>If the <code class="highlighter-rouge">sign-git-tag</code> config is set, then the tag will be signed using
the <code class="highlighter-rouge">-s</code> flag to git.  Note that you must have a default GPG key set up
in your git config for this to work properly.  For example:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>npm config <span class="nb">set </span>sign-git-tag <span class="nb">true</span>
<span class="nv">$ </span>npm version patch

You need a passphrase to unlock the secret key <span class="k">for
</span>user: <span class="s2">"isaacs (http://blog.izs.me/) &lt;i@izs.me&gt;"</span>
2048-bit RSA key, ID 6C481CF6, created 2010-08-31

Enter passphrase:
</code></pre></div></div>

<p>If <code class="highlighter-rouge">preversion</code>, <code class="highlighter-rouge">version</code>, or <code class="highlighter-rouge">postversion</code> are in the <code class="highlighter-rouge">scripts</code> property of
the package.json, they will be executed as part of running <code class="highlighter-rouge">npm version</code>.</p>

<p>The exact order of execution is as follows:</p>
<ol>
  <li>Check to make sure the git working directory is clean before we get started.
Your scripts may add files to the commit in future steps.
This step is skipped if the <code class="highlighter-rouge">--force</code> flag is set.</li>
  <li>Run the <code class="highlighter-rouge">preversion</code> script. These scripts have access to the old <code class="highlighter-rouge">version</code> in package.json.
A typical use would be running your full test suite before deploying.
Any files you want added to the commit should be explicitly added using <code class="highlighter-rouge">git add</code>.</li>
  <li>Bump <code class="highlighter-rouge">version</code> in <code class="highlighter-rouge">package.json</code> as requested (<code class="highlighter-rouge">patch</code>, <code class="highlighter-rouge">minor</code>, <code class="highlighter-rouge">major</code>, etc).</li>
  <li>Run the <code class="highlighter-rouge">version</code> script. These scripts have access to the new <code class="highlighter-rouge">version</code> in package.json
(so they can incorporate it into file headers in generated files for example).
Again, scripts should explicitly add generated files to the commit using <code class="highlighter-rouge">git add</code>.</li>
  <li>Commit and tag.</li>
  <li>Run the <code class="highlighter-rouge">postversion</code> script. Use it to clean up the file system or automatically push
the commit and/or tag.</li>
</ol>

<p>Take the following example:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="nl">"scripts"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"preversion"</span><span class="p">:</span><span class="w"> </span><span class="s2">"npm test"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"npm run build &amp;&amp; git add -A dist"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"postversion"</span><span class="p">:</span><span class="w"> </span><span class="s2">"git push &amp;&amp; git push --tags &amp;&amp; rm -rf build/temp"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>This runs all your tests, and proceeds only if they pass. Then runs your <code class="highlighter-rouge">build</code> script, and
adds everything in the <code class="highlighter-rouge">dist</code> directory to the commit. After the commit, it pushes the new commit
and tag up to the server, and deletes the <code class="highlighter-rouge">build/temp</code> directory.</p>

<h3 id="configuration">Configuration</h3>

<h4 id="allow-same-version">allow-same-version</h4>

<ul>
  <li>Default: false</li>
  <li>Type: Boolean</li>
</ul>

<p>Prevents throwing an error when <code class="highlighter-rouge">npm version</code> is used to set the new version 
to the same value as the current version.</p>

<h4 id="git-tag-version">git-tag-version</h4>

<ul>
  <li>Default: true</li>
  <li>Type: Boolean</li>
</ul>

<p>Commit and tag the version change.</p>

<h4 id="commit-hooks">commit-hooks</h4>

<ul>
  <li>Default: true</li>
  <li>Type: Boolean</li>
</ul>

<p>Run git commit hooks when committing the version change.</p>

<h4 id="sign-git-tag">sign-git-tag</h4>

<ul>
  <li>Default: false</li>
  <li>Type: Boolean</li>
</ul>

<p>Pass the <code class="highlighter-rouge">-s</code> flag to git to sign the tag.</p>

<p>Note that you must have a default GPG key set up in your git config for this to work properly.</p>

<h3 id="see-also">See Also</h3>

<ul>
  <li><a href="/cli-commands/npm-init">npm init</a></li>
  <li><a href="/cli-commands/npm-run-script">npm run-script</a></li>
  <li><a href="/using-npm/scripts">npm scripts</a></li>
  <li><a href="/configuring-npm/package-json">package.json</a></li>
  <li><a href="/using-npm/semver">semver</a></li>
  <li><a href="/using-npm/config">config</a></li>
</ul>
